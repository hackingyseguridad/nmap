description = [[
Script para nmap, para detectar recurso J-Web de Juniper/about.php, relacionados con la vulnerabilidad, CVE-2023-36845 en firewall Juniper
puertos TCP habituales web: 80,10443,5411,443,4433,8443,4443,444,9443,7443,1723,6443,8009,10000,55443,9000,8081,8880,8889,9001
]]
local http = require "http"
local shortport = require "shortport"
local vulns = require "vulns"
local stdnse = require "stdnse"
local string = require "string"
----
-- @antonio_taboada
-- nmap -p <port> --script cve-CVE-2023-36845.nse <target>
---
author = "hackingyseguridad.com"
license = "Same as Nmap--See https://nmap.org/book/man-legal.html"
categories = { "vuln" }

portrule = shortport.http

  action = function(host, port)
  local vuln = {
    title = "Detecta recurso J-web de Juniper https://IP/about.php?PHPRC=/dev/fd/0, vulnerabilidad, CVE-2023-36845",
    state = vulns.STATE.NOT_VULN,
    description = [[
    ]],
    IDS = {
        CVE = "CVE-2023-36845"
    },
    references = {
        'https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-36845',
    },
    dates = {
        disclosure = { year = '2024', month = '01', day = '31' }
    }
  }
 options = {header={}}    options['header']['User-Agent'] = "Node.js"
 local vuln_report = vulns.Report:new(SCRIPT_NAME, host, port)
 local url = stdnse.get_script_args(SCRIPT_NAME..".url") or "/about.php"
 local response = http.generic_request(host, port, "GET", "/about.php", options)

 if response.status == 200 then
 vuln.state = vulns.STATE.VULN
 end
 return vuln_report:make_output(vuln)
end
---- www.hackingyseguridad.coom ----


